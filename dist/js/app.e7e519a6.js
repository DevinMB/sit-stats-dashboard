(function(){"use strict";var e={2331:function(e,t,i){var a=i(9242),n=i(3396);const s={id:"app"},r=(0,n._)("header",null,[(0,n._)("h1",null,"Device Dashboard")],-1),o=(0,n._)("footer",null,[(0,n._)("p",null,"Â© Devin's Bad Device Dashboard")],-1);function c(e,t,i,a,c,l){const u=(0,n.up)("DeviceGrid");return(0,n.wg)(),(0,n.iD)("div",s,[r,(0,n._)("main",null,[(0,n.Wm)(u)]),o])}const l={class:"device-grid"};function u(e,t,i,s,r,o){const c=(0,n.up)("DeviceCard"),u=(0,n.up)("DeviceStatsSummary");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",l,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.devices,((e,t)=>((0,n.wg)(),(0,n.j4)(c,{key:t,device:e,onSelectDevice:o.toggleDeviceStats},null,8,["device","onSelectDevice"])))),128))]),(0,n.Wm)(a.uT,{name:"expand"},{default:(0,n.w5)((()=>[r.selectedDevice?((0,n.wg)(),(0,n.j4)(u,{deviceId:r.selectedDevice,key:r.selectedDevice},null,8,["deviceId"])):(0,n.kq)("",!0)])),_:1})],64)}var d=i(65),v=i(7139),m=i.p+"img/chair-sensor-1.abbace8f.jpg";const p=e=>((0,n.dD)("data-v-aff9dbd2"),e=e(),(0,n.Cn)(),e),f=p((()=>(0,n._)("div",{class:"device-image-container"},[(0,n._)("img",{src:m,alt:"Device Image",class:"device-image"})],-1))),h={class:"device-info"},g={class:"device-name"},D={class:"device-status"};function S(e,t,i,a,s,r){const o=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",{class:"device-card",onClick:t[0]||(t[0]=(...e)=>r.handleClick&&r.handleClick(...e))},[f,(0,n._)("div",h,[(0,n._)("h3",g,(0,v.zw)(i.device.deviceId),1),(0,n._)("p",D,[(0,n._)("span",{class:(0,v.C_)({"status-circle":!0,active:i.device.active,inactive:!i.device.active})},null,2),(0,n.Uk)(" "+(0,v.zw)(i.device.status),1)]),(0,n.Wm)(o,{to:`/device/${i.device.id}`,class:"details-link"},{default:(0,n.w5)((()=>[(0,n.Uk)("View Details")])),_:1},8,["to"])])])}var _={name:"DeviceCard",props:{device:{type:Object,required:!0}},methods:{handleClick(){this.$emit("selectDevice",this.device.deviceId)}}},y=i(89);const w=(0,y.Z)(_,[["render",S],["__scopeId","data-v-aff9dbd2"]]);var b=w;const T=e=>((0,n.dD)("data-v-2ecc31d8"),e=e(),(0,n.Cn)(),e),k=T((()=>(0,n._)("h5",null,"Default filter is sits greater than 10s",-1))),V={key:0},C={key:1},x={key:2,class:"device-stats-container"},A={class:"stat-section"},U=T((()=>(0,n._)("h5",null,"Last Sit",-1))),E=T((()=>(0,n._)("strong",null,"Date Time:",-1))),O=T((()=>(0,n._)("strong",null,"Duration:",-1))),z=T((()=>(0,n._)("strong",null,"Average Value:",-1))),j={class:"stat-section"},I=T((()=>(0,n._)("h5",null,"Max Sit",-1))),$=T((()=>(0,n._)("strong",null,"Date Time:",-1))),M=T((()=>(0,n._)("strong",null,"Duration:",-1))),Z=T((()=>(0,n._)("strong",null,"Average Value:",-1))),F={class:"stat-section"},P=T((()=>(0,n._)("h5",null,"Sit Counts",-1))),W=T((()=>(0,n._)("strong",null,"Morning:",-1))),N=T((()=>(0,n._)("strong",null,"Afternoon:",-1))),q=T((()=>(0,n._)("strong",null,"Evening:",-1))),G=T((()=>(0,n._)("strong",null,"Night:",-1))),L=T((()=>(0,n._)("strong",null,"Total:",-1))),Y={class:"stat-section"},H=T((()=>(0,n._)("h5",null,"Total Sit Time",-1))),J={key:3},B={class:"filters-container"};function K(e,t,i,s,r,o){const c=(0,n.up)("VueDatePicker");return(0,n.wg)(),(0,n.iD)("div",{class:(0,v.C_)(["device-stats-summary",{"is-floating":r.showFilters}])},[(0,n._)("h2",null,(0,v.zw)(i.deviceId)+" Summary",1),k,r.loading?((0,n.wg)(),(0,n.iD)("div",V,"Loading...")):r.error?((0,n.wg)(),(0,n.iD)("div",C,"Error: "+(0,v.zw)(r.error),1)):r.deviceStats?((0,n.wg)(),(0,n.iD)("div",x,[(0,n._)("div",A,[U,(0,n._)("p",null,[E,(0,n.Uk)(" "+(0,v.zw)(o.formatEpochToDateTime(r.deviceStats.lastSit.startTimestamp)),1)]),(0,n._)("p",null,[O,(0,n.Uk)(" "+(0,v.zw)(o.formatDuration(r.deviceStats.lastSit.sitDuration)),1)]),(0,n._)("p",null,[z,(0,n.Uk)(" "+(0,v.zw)(r.deviceStats.lastSit.avgValue),1)])]),(0,n._)("div",j,[I,(0,n._)("p",null,[$,(0,n.Uk)(" "+(0,v.zw)(o.formatEpochToDateTime(r.deviceStats.maxSit.startTimestamp)),1)]),(0,n._)("p",null,[M,(0,n.Uk)(" "+(0,v.zw)(o.formatDuration(r.deviceStats.maxSit.sitDuration)),1)]),(0,n._)("p",null,[Z,(0,n.Uk)(" "+(0,v.zw)(r.deviceStats.maxSit.avgValue),1)])]),(0,n._)("div",F,[P,(0,n._)("p",null,[W,(0,n.Uk)(" "+(0,v.zw)(r.deviceStats.sitCounter.morningSitCount),1)]),(0,n._)("p",null,[N,(0,n.Uk)(" "+(0,v.zw)(r.deviceStats.sitCounter.afternoonSitCount),1)]),(0,n._)("p",null,[q,(0,n.Uk)(" "+(0,v.zw)(r.deviceStats.sitCounter.eveningSitCount),1)]),(0,n._)("p",null,[G,(0,n.Uk)(" "+(0,v.zw)(r.deviceStats.sitCounter.nightSitCount),1)]),(0,n._)("p",null,[L,(0,n.Uk)(" "+(0,v.zw)(r.deviceStats.sitCounter.totalSitCount),1)])]),(0,n._)("div",Y,[H,(0,n._)("p",null,(0,v.zw)(o.formatDuration(r.deviceStats.totalSitTime)),1)])])):((0,n.wg)(),(0,n.iD)("div",J," No stats to display. ")),(0,n.Wm)(a.uT,{name:"filter-toggle"},{default:(0,n.w5)((()=>[(0,n._)("div",B,[(0,n.Wm)(c,{modelValue:r.filters.startTimestamp,"onUpdate:modelValue":t[0]||(t[0]=e=>r.filters.startTimestamp=e),"is-24":!1,placeholder:"Start Timestamp"},null,8,["modelValue"]),(0,n.Wm)(c,{modelValue:r.filters.endTimestamp,"onUpdate:modelValue":t[1]||(t[1]=e=>r.filters.endTimestamp=e),"is-24":!1,placeholder:"End Timestamp"},null,8,["modelValue"]),(0,n.wy)((0,n._)("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=e=>r.filters.minDuration=e),placeholder:"Min Duration (Seconds)"},null,512),[[a.nr,r.filters.minDuration]]),(0,n.wy)((0,n._)("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=e=>r.filters.maxDuration=e),placeholder:"Max Duration (Seconds)"},null,512),[[a.nr,r.filters.maxDuration]]),(0,n.wy)((0,n._)("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>r.filters.minAvgValue=e),placeholder:"Min Avg Value"},null,512),[[a.nr,r.filters.minAvgValue]]),(0,n.wy)((0,n._)("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=e=>r.filters.maxAvgValue=e),placeholder:"Max Avg Value"},null,512),[[a.nr,r.filters.maxAvgValue]]),(0,n._)("button",{onClick:t[6]||(t[6]=(...e)=>o.fetchDeviceStats&&o.fetchDeviceStats(...e))},"Apply")])])),_:1})],2)}var Q=i(1076);const R="http://192.168.1.250:5001";var X={async fetchDeviceStatus(){try{const e=await Q.Z.get(`${R}/sit-stats/devices`);return e.data}catch(e){throw console.error("Error fetching device status:",e),e}},async fetchSitStatistics(){try{const e=await Q.Z.get(`${R}/sit-stats/chair-sensor-1`);return e.data}catch(e){throw console.error("Error fetching sit statistics:",e),e}},async getDeviceSummaryStats(e,t,i,a,n,s,r){try{const o={startTimestamp:t,endTimestamp:i,minDuration:a,maxDuration:n,minAvgValue:s,maxAvgValue:r};Object.keys(o).forEach((e=>void 0===o[e]&&delete o[e]));const c=await Q.Z.get(`${R}/sit-stats/${e}`,{params:o});return c.data}catch(o){throw console.error("Error fetching device stats:",o.message),o}},async getDeviceListing(){try{const e=await Q.Z.get(`${R}/sit-stats/devices`);return e.data}catch(e){throw console.error("Error fetching device status:",e),e}},async getDeviceStatus(e){try{const t=await Q.Z.get(`${R}/sit-stats/${e}/status`);return t.data}catch(t){throw console.error("Error fetching device status:",t.message),t}},async getDeviceSits(e,t,i,a,n,s,r){try{const o={startTimestamp:t,endTimestamp:i,minDuration:a,maxDuration:n,minAvgValue:s,maxAvgValue:r};Object.keys(o).forEach((e=>void 0===o[e]&&delete o[e]));const c=await Q.Z.get(`${R}/sit-stats/${e}/sits`,{params:o});return c.data}catch(o){throw console.error("Error fetching device sits:",o.message),o}}},ee=i(3960),te={name:"DeviceStatsSummary",components:{VueDatePicker:ee.Z},props:{deviceId:{type:String,required:!0}},data(){return{showFilters:!1,deviceStats:null,loading:!1,error:null,filters:{startTimestamp:null,endTimestamp:null,minDuration:10,maxDuration:null,minAvgValue:null,maxAvgValue:null}}},async created(){await this.fetchDeviceStats()},methods:{...(0,d.nv)(["updateDeviceStats"]),async fetchDeviceStats(){this.loading=!0;try{const e=this.formatDateToEpoch(this.filters.startTimestamp),t=this.formatDateToEpoch(this.filters.endTimestamp);this.deviceStats=await X.getDeviceSummaryStats(this.deviceId,e,t,this.filters.minDuration,this.filters.maxDuration,this.filters.minAvgValue,this.filters.maxAvgValue),this.updateDeviceStats(this.deviceStats)}catch(e){this.error=e.message}finally{this.loading=!1}},formatDateToEpoch(e){return e?Math.floor(e.getTime()/1e3):null},formatEpochToDateTime(e){const t=new Date(1e3*e),i={timeZone:"America/New_York",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0};return new Intl.DateTimeFormat("en-US",i).format(t)},toggleFilters(){this.showFilters=!this.showFilters},formatDuration(e){const t=Math.floor(e/3600),i=Math.floor(e%3600/60),a=e%60;return`${t}h ${i}m ${a}s`}}};const ie=(0,y.Z)(te,[["render",K],["__scopeId","data-v-2ecc31d8"]]);var ae=ie,ne={name:"DeviceGrid",components:{DeviceCard:b,DeviceStatsSummary:ae},computed:{...(0,d.rn)({devices:e=>e.devices})},data(){return{selectedDevice:null}},methods:{toggleDeviceStats(e){this.selectedDevice=this.selectedDevice===e?null:e}}};const se=(0,y.Z)(ne,[["render",u],["__scopeId","data-v-3a10bf28"]]);var re=se,oe=i(4029),ce=i.n(oe),le=i(3266),ue=i.n(le),de=(0,d.MT)({state:{devices:{},deviceStats:null,deviceSits:null},mutations:{setDeviceStatus(e,t){if(Array.isArray(t)){const i={};t.forEach((e=>{i[e.deviceId]=e})),e.devices=i}else e.devices[t.deviceId]=t},setDeviceStats(e,t){e.deviceStats=t},setDeviceSits(e,t){e.deviceSits=t}},actions:{updateDeviceStatus({commit:e},t){e("setDeviceStatus",t)},updateDeviceStats({commit:e},t){e("setDeviceStats",t)},updateDeviceSits({commit:e},t){e("setDeviceSits",t)}}});let ve=null;const me=e=>{const t="string"===typeof e?JSON.parse(e):e;de.dispatch("updateDeviceStatus",t)},pe=()=>{ve.subscribe("/topic/status",(e=>{const t="string"===typeof e.body?JSON.parse(e.body):e.body;Array.isArray(t)?de.dispatch("updateDeviceStatus",t):me(t)})),ve.send("/app/status",{},"{}")},fe=()=>{const e=new(ce())("http://192.168.1.250:5001/ws");ve=ue().over(e),ve.connect({},(()=>{pe()}),(e=>{console.error("Connection error: "+e)}))};var he={connect:fe},ge={name:"App",components:{DeviceGrid:re},mounted(){he.connect()}};const De=(0,y.Z)(ge,[["render",c]]);var Se=De;const _e=(0,a.ri)(Se);_e.use(de),_e.mount("#app")}},t={};function i(a){var n=t[a];if(void 0!==n)return n.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,i),s.exports}i.m=e,function(){var e=[];i.O=function(t,a,n,s){if(!a){var r=1/0;for(u=0;u<e.length;u++){a=e[u][0],n=e[u][1],s=e[u][2];for(var o=!0,c=0;c<a.length;c++)(!1&s||r>=s)&&Object.keys(i.O).every((function(e){return i.O[e](a[c])}))?a.splice(c--,1):(o=!1,s<r&&(r=s));if(o){e.splice(u--,1);var l=n();void 0!==l&&(t=l)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[a,n,s]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.p="/"}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,s,r=a[0],o=a[1],c=a[2],l=0;if(r.some((function(t){return 0!==e[t]}))){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);if(c)var u=c(i)}for(t&&t(a);l<r.length;l++)s=r[l],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return i.O(u)},a=self["webpackChunksit_stats_dashboard"]=self["webpackChunksit_stats_dashboard"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=i.O(void 0,[998],(function(){return i(2331)}));a=i.O(a)})();
//# sourceMappingURL=app.e7e519a6.js.map